<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>My Timer - 篠ノ井乗務区</title>
<style>
body { background-color: #f5f5f5; color: #333; font-family: "serif"; text-align: center; padding: 20px; }
.container { border: 3px solid #004d40; padding: 30px; max-width: 500px; margin: auto; background: #fff; }
.timer { font-size: 2.5em; font-weight: bold; color: #004d40; margin: 20px 0; }
input { padding: 10px; font-size: 1em; width: 80%; margin-bottom: 10px; }
.note { font-size: 0.8em; color: #666; margin-bottom: 20px; text-align: left; padding: 10px; background: #eee; }
.menu-btn { display: block; background: #d32f2f; color: #fff; padding: 12px; text-decoration: none; font-weight: bold; border-radius: 4px; margin-top: 10px; }
</style>
</head>
<body>
<div class="container">
    <h1>マイ・タイマー</h1>
    <div id="display" class="timer">--:--:--</div>
    <input type="datetime-local" id="target">
    <button onclick="saveTimer()" style="padding:10px 20px; cursor:pointer;">保存する / Save</button>
    
    <div class="note">
        ※設定した時間は今のブラウザに保存されます。スマホとパソコンでデータは共有されません。
    </div>

    <a href="index.html" class="menu-btn">戻る / Back</a>
</div>
<script>
let goal = null;

// 保存された時間を読み込む
window.onload = function() {
    const saved = localStorage.getItem('shinonoi_mytimer');
    if (saved) {
        goal = new Date(saved);
        document.getElementById("target").value = saved;
    }
}

function saveTimer() {
    const val = document.getElementById("target").value;
    if (val) {
        goal = new Date(val);
        localStorage.setItem('shinonoi_mytimer', val);
        alert("保存しました。");
    }
}

function update() {
    if (!goal) return;
    const diff = goal - new Date();
    if (diff <= 0) { document.getElementById("display").innerText = "出発進行！"; return; }
    const d = Math.floor(diff/(1000*60*60*24));
    const h = String(Math.floor((diff/(1000*60*60))%24)).padStart(2,'0');
    const m = String(Math.floor((diff/(1000*60))%60)).padStart(2,'0');
    const s = String(Math.floor((diff/1000)%60)).padStart(2,'0');
    document.getElementById("display").innerText = `${d}d ${h}:${m}:${s}`;
}
setInterval(update, 1000);
</script>
</body>
</html>
