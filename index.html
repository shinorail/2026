<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>篠ノ井乗務区 - Shinonoi Depot</title>
<style>
:root {
    --main-bg: #fcfaf2; --main-text: #333; --accent-red: #d32f2f; --accent-green: #004d40;
    --font-family: "BIZ UDPGothic", sans-serif;
}
body { background: var(--main-bg); color: var(--main-text); font-family: var(--font-family); text-align: center; margin: 0; padding: 20px; line-height: 1.6; }

/* 高コントラストモード共通設定 */
body.high-contrast { background: #000 !important; color: #fff !important; }
body.high-contrast .container, body.high-contrast .setup-banner { background: #000 !important; border: 2px solid #fff !important; color: #fff !important; }
body.high-contrast .menu-btn, body.high-contrast .toggle-btn.on { background: #fff !important; color: #000 !important; }

/* 未同意時の制限 */
.content-wrapper { filter: blur(8px); pointer-events: none; transition: 0.5s; }
.content-wrapper.active { filter: blur(0); pointer-events: auto; }

.container { border: 3px solid var(--accent-red); padding: 30px 20px; max-width: 500px; margin: 10px auto; background: rgba(255,255,255,0.95); border-radius: 20px; }

/* ポップアップバナー */
.setup-banner { position: fixed; bottom: 0; left: 0; width: 100%; background: #222; color: #fff; padding: 20px 0; z-index: 2000; box-shadow: 0 -5px 20px rgba(0,0,0,0.3); }
.setup-grid { max-width: 500px; margin: auto; padding: 0 20px; }
.setup-item { display: flex; justify-content: space-between; align-items: center; background: #333; padding: 10px 15px; border-radius: 10px; margin-bottom: 10px; }
.toggle-switch { cursor: pointer; background: #555; border: none; color: #fff; padding: 8px 20px; border-radius: 20px; font-weight: bold; }
.toggle-switch.on { background: #2e7d32; }
.confirm-btn { width: 100%; background: var(--accent-red); color: #fff; border: none; padding: 15px; border-radius: 10px; font-weight: bold; margin-top: 10px; cursor: not-allowed; opacity: 0.5; }
.confirm-btn.ready { cursor: pointer; opacity: 1; }

/* フッター広告・設定エリア */
.footer-area { margin-top: 50px; padding: 20px; border-top: 1px solid #ccc; font-size: 12px; }
.ad-banner { background: #eee; height: 90px; display: flex; align-items: center; justify-content: center; margin-bottom: 15px; border-radius: 8px; color: #999; }
.setting-trigger { background: none; border: 1px solid #999; color: #666; padding: 5px 15px; border-radius: 15px; cursor: pointer; }

.hidden { display: none; }
</style>
</head>
<body>

<div id="setup-banner" class="setup-banner">
    <div class="setup-grid">
        <p style="font-weight:bold; margin-bottom:15px;">篠ノ井乗務区：ご利用前確認</p>
        <div class="setup-item">
            <span>サイトポリシーの確認</span>
            <button id="p-toggle" class="toggle-switch" onclick="toggleState('policy')">未</button>
        </div>
        <div class="setup-item">
            <span>高コントラストモード</span>
            <button id="a-toggle" class="toggle-switch" onclick="toggleState('access')">オフ</button>
        </div>
        <button id="c-btn" class="confirm-btn" onclick="acceptAll()">出発進行</button>
    </div>
</div>

<div id="wrapper" class="content-wrapper">
    <div class="container">
        <h1 onclick="devAccess()">篠ノ井乗務区</h1>
        <div class="ad-banner">広告掲載予定エリア</div>
        
        <div id="timer-section" style="margin:20px 0;">
            <p>2026年 始発列車まで</p>
            <div id="countdown" style="font-size:2em; font-weight:bold; color:var(--accent-red);">--:--:--</div>
        </div>

        <div id="omikuji-area" class="hidden" style="display:flex; justify-content:center; gap:20px; margin:20px 0;">
            <a href="rail_result.html" style="background:var(--accent-green); color:#fff; width:100px; height:100px; border-radius:30%; display:flex; align-items:center; justify-content:center; text-decoration:none; font-weight:bold;">鉄道みくじ</a>
            <a href="norm_result.html" style="background:var(--accent-red); color:#fff; width:100px; height:100px; border-radius:50%; display:flex; align-items:center; justify-content:center; text-decoration:none; font-weight:bold;">一般みくじ</a>
        </div>

        <div style="display:flex; flex-direction:column; gap:10px;">
            <a href="news.html" class="menu-btn" style="background:var(--accent-green); color:#fff; padding:12px; border-radius:30px; text-decoration:none; font-weight:bold;">お知らせ</a>
            <a href="policy.html" style="font-size:12px; color:#666;">利用規約・AIポリシー</a>
        </div>
    </div>

    <footer class="footer-area">
        <div class="ad-banner">フッター広告エリア</div>
        <button class="setting-trigger" onclick="toggleHighContrast()">視覚設定（高コントラスト）切替</button>
        <p>&copy; 2025 篠ノ井乗務区</p>
    </footer>
</div>

<script>
let state = { policy: false, access: false };

function toggleState(type) {
    if (type === 'policy') {
        state.policy = !state.policy;
        document.getElementById('p-toggle').innerText = state.policy ? "同意" : "未";
        document.getElementById('p-toggle').classList.toggle('on', state.policy);
    } else {
        state.access = !state.access;
        document.getElementById('a-toggle').innerText = state.access ? "オン" : "オフ";
        document.getElementById('a-toggle').classList.toggle('on', state.access);
        localStorage.setItem('shinonoi_contrast', state.access ? 'on' : 'off');
        applyAccessibility();
    }
    const cBtn = document.getElementById('c-btn');
    if (state.policy) { cBtn.classList.add('ready'); cBtn.style.cursor = 'pointer'; }
    else { cBtn.classList.remove('ready'); cBtn.style.cursor = 'not-allowed'; }
}

function acceptAll() {
    if (!state.policy) return;
    localStorage.setItem('shinonoi_setup', 'done');
    document.getElementById('setup-banner').style.display = 'none';
    document.getElementById('wrapper').classList.add('active');
}

if (localStorage.getItem('shinonoi_setup') === 'done') {
    document.getElementById('setup-banner').style.display = 'none';
    document.getElementById('wrapper').classList.add('active');
}

function applyAccessibility() {
    const isContrast = localStorage.getItem('shinonoi_contrast') === 'on';
    document.body.classList.toggle('high-contrast', isContrast);
}

function toggleHighContrast() {
    const current = localStorage.getItem('shinonoi_contrast');
    localStorage.setItem('shinonoi_contrast', current === 'on' ? 'off' : 'on');
    applyAccessibility();
}

// 簡易タイマー
const start = new Date("2026/01/01 00:00:00");
setInterval(() => {
    const now = new Date();
    if (now >= start) {
        document.getElementById("timer-section").classList.add("hidden");
        document.getElementById("omikuji-area").classList.remove("hidden");
    } else {
        const diff = start - now;
        const d = Math.floor(diff / 86400000);
        const h = String(Math.floor((diff % 86400000) / 3600000)).padStart(2, '0');
        const m = String(Math.floor((diff % 3600000) / 60000)).padStart(2, '0');
        const s = String(Math.floor((diff % 60000) / 1000)).padStart(2, '0');
        document.getElementById("countdown").innerText = `${d}d ${h}:${m}:${s}`;
    }
}, 1000);

applyAccessibility();
</script>
</body>
</html>
